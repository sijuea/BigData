<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.demo.mapper.DAUMapper">



  <select id="selectCount" resultType="java.lang.Integer">
    select
        count(*)
    from GMALL2021_DAU
    where LOGDATE=#{date}
  </select>


  <select id="selectNew"  resultType="java.lang.Integer">
    select count(*) from
    (select
        MID
    from GMALL2021_DAU
        where LOGDATE=#{date})t1
        left join
        (
        select
            MID
        from GMALL2021_DAU
        where LOGDATE &lt; #{date} group by MID
        )t2 on t1.MID=t2.MID where t2.MID is null
  </select>


  <select id="getHourOfDay"  resultType="com.demo.entity.DAUPreHour">
      select
      LOGHOUR hour,
        count(*) count
    from GMALL2021_DAU
    where LOGDATE=#{date}
    group by LOGHOUR
  </select>
</mapper>